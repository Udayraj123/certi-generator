!function($,t){function n(t){var n={fontSize:t.css("font-size"),lineHeight:t.css("line-height")};return t.addClass(O.input).attr({autocomplete:"off",spellcheck:!1}),t.attr("id")||t.attr("id",E+"_"+q().index(t)),{id:t[0].id,el:t,css:n,placeholder:t.attr("placeholder")}}function e(t){var n=t.input.el,e=$("<span>").attr({id:t.input.id+"_swatch",class:O.swatch}),i=a(t);return i.button.appendTo(e),{el:e,button:i.button,swatch:i.swatch}}function a(t){var n=$("<button>").attr({type:"button",class:O.swatchButton,title:copy.swatchToggle,"aria-label":copy.swatchToggle,"aria-controls":t.input.id+"_controls","aria-expanded":"false"}).on("click",function(){J.toggle(t)}),e=$("<span>").appendTo(n);return e.after(i()),{button:n,swatch:e}}function i(t){return'<svg xmlns="http://www.w3.org/2000/svg"viewBox="0 0 26 26"><polyline points="17 11 13 15 9 11"fill="none"stroke="#000"stroke-linecap="round"stroke-linejoin="round"stroke-width="0.75"/></svg>'}function l(t){var n=$('<span class="'+O.wrap+'"></span>');return t.input.el.wrap(n).after(t.swatch.el,t.controls.el).on("keyup",function(){w(t)}),n=t.input.el.parent(),{el:n}}function o(t){var n={hue:s({type:"hue",label:"Hue",id:t.input.id+"_slider__hue",class:O.hue,min:0,max:360,step:.5,val:0,picker:t}),saturation:s({type:"saturation",label:"Saturation",id:t.input.id+"_slider__saturation",class:O.saturation,min:0,max:1,step:.01,val:.75,picker:t}),value:s({type:"value",label:"Value",id:t.input.id+"_slider__value",class:O.value,min:0,max:1,step:.01,val:1,picker:t}),alpha:s({type:"alpha",label:"Alpha",id:t.input.id+"_slider__alpha",class:O.alpha,min:0,max:1,step:.01,val:1,picker:t})};return t.controls.el.append(n.hue.input,n.saturation.input,n.value.input,n.alpha.input),n}function s(t){return{input:$("<input>").attr({type:"range",id:t.id,class:O.slider+" "+t.class,min:t.min,max:t.max,step:t.step,title:t.label,"aria-label":t.label}).val(t.val).on("input change",function(n){b($(this).val(),t.type,t.picker)}),value:t.val}}function r(t){var n=t.input.el,e=$("<div>").attr({id:t.input.id+"_controls",class:O.controls,hidden:"hidden",role:"dialog"});return{el:e,close:u(t).appendTo(e),hidden:!0}}function u(t){var n=$("<button>").attr({type:"button",class:O.closeButton,title:copy.controlsClose,"aria-label":copy.controlsClose,"aria-controls":t.input.id+"_controls","aria-expanded":"false"}).on("click",function(){J.hide(t)});return n.append(c()),n}function c(t){return'<svg xmlns="http://www.w3.org/2000/svg"viewBox="0 0 26 26"><polyline points="17 9 13 13 9 9"fill="none"stroke="#999"stroke-linecap="round"stroke-linejoin="round"stroke-width="1"/><polyline points="17 17 13 13 9 17"fill="none"stroke="#999"stroke-linecap="round"stroke-linejoin="round"stroke-width="1"/></svg>'}function p(t){var a={};return a.input=n(t),a.swatch=e(a),a.controls=r(a),a.sliders=o(a),a.wrap=l(a),a.value=a.input.el.val(),t.data(E,a),a}function h(t){d(t),v(t),g(t)}function d(n){var e=n.sliders,a=f({start:t({h:e.hue.value,s:0,v:1}).toRgbString(),end:t({h:e.hue.value,s:1,v:1}).toRgbString()},e.saturation.input);e.saturation.input.css("background-image",a)}function v(n){var e=n.sliders,a=f({start:t({h:e.hue.value,s:e.saturation.value,v:0}).toRgbString(),end:t({h:e.hue.value,s:e.saturation.value,v:1}).toRgbString()},e.value.input);e.value.input.css("background-image",a)}function g(t){var n=t.sliders,e=N(t),a=k({start:e.setAlpha(0).toRgbString(),end:e.setAlpha(1).toRgbString()},n.alpha.input);n.alpha.input.css(a)}function f(t,n){var e=n[0].clientHeight;return e&&(t.start+=e/2+"px",t.end+=" calc(100% - "+e/2+"px)"),"linear-gradient(90deg,"+t.start+","+t.end+")"}function k(t,n){n.css({"background-image":"","background-size":"","background-position":""});var e={height:n[0].clientHeight,image:n.css("background-image"),size:n.css("background-size"),position:n.css("background-position")};return e.height&&(t.end+=" calc(100% - "+e.height/2+"px)"),{"background-image":"linear-gradient(90deg,"+t.start+", "+t.end+"), "+e.image,"background-size":"cover, "+e.size,"background-position":"0 0, "+e.position}}function b(t,n,e){S(n,e),y(e)}function w(t){x(t)}function _(t){t.input.el.data(E,t),t.input.el.trigger("change")}function m(t,n){A(t,n),P(n),R(n),T(n),V(n)}function x(t){C(t),T(t),V(t)}function y(t){z(t),R(t),T(t)}function A(t,n){return n.value!==t&&(t||(n.value="",n.value=I(n)),n.options.useLastValid&&!D(t,n)||(n.value=t),n.value)}function C(t){A(t.input.el.val(),t)&&(P(t),_(t))}function S(t,n){var e=n.sliders[t];e.value=parseFloat(e.input.val()),H(t,n),_(n)}function z(t){var n=N(t),e=n.toName()||n.toRgbString();t.options.forceHex&&(e=n.toHexString()),t.value=e}function H(t,n){var e=n.sliders;n.options.noAlpha&&(e.alpha.value=1),n.options.autoSliders&&(t&&"alpha"!==t&&0===e.alpha.value&&(e.alpha.value=1),"hue"===t&&0===e.saturation.value&&(e.saturation.value=.75),"hue"!==t&&"saturation"!==t||0!==e.value.value||(e.value.value=1)),V(n)}function P(n){var e=t(n.value).toHsv();e.a=n.options.noAlpha?1:t(n.value).getAlpha(),n.sliders.hue.value=e.h,n.sliders.saturation.value=e.s,n.sliders.value.value=e.v,n.sliders.alpha.value=e.a}function B(t){T(t),V(t)}function R(t){t.input.el.val(t.value)}function T(t){t=t||Q(this),t.swatch.swatch.css("background-color",I(t)),F(t)}function j(t,n){var e=n.sliders[t];e.input.val(e.value)}function V(n){t(n.value).toHsv().a=t(n.value).getAlpha(),j("hue",n),j("saturation",n),j("value",n),j("alpha",n),h(n)}function I(t){return D(t.value,t)?t.value:D(t.input.placeholder,t)?t.input.placeholder:t.options.noAlpha?t.options.fallback:t.options.fallbackAlpha}function L(t){t.value=I(t),P(t)}function F(n){var e=t(n.value),a=e.getBrightness(),i=e.getAlpha(),l=a/255<.6&&i>.4;n.wrap.el.removeClass("_light _dark").addClass(l?"_dark":"_light")}function N(n){return t({h:n.sliders.hue.value,s:n.sliders.saturation.value,v:n.sliders.value.value,a:n.sliders.alpha.value})}function Q(t){return t.data()[E]}function q(){return $("."+O.input)}function D(n,e){var a=t(n);return(!e||!e.options.noAlpha||1===a.getAlpha())&&a.isValid()}var E="colourpicker",G,J,K,M,O;O={wrap:E,input:E+"_input",swatch:E+"_swatch",swatchButton:E+"_swatch_button",controls:E+"_controls",closeButton:E+"_close",label:E+"_label",slider:E+"_slider",hue:"_hue",saturation:"_saturation",value:"_value",alpha:"_alpha"},copy={swatchToggle:"Toggle Controls",controlsClose:"Close Controls"},G={autoSliders:!0,fallback:"black",fallbackAlpha:"transparent",forceHex:!1,matchInput:!1,noAlpha:!1,useLastValid:!0},J={init:function(t){function n(){var n=$(this),e=$.extend({},G,t),a=p(n);J.options(e,a),B(a)}return this.each(n)},options:function(t,n){return n=n||Q(this),n.options=t,"true"==n.input.el.attr("no-alpha")&&(n.options.noAlpha=!0),n.options.noAlpha?(n.wrap.el.addClass("_no-alpha"),n.sliders.alpha.input.attr("hidden","hidden")):(n.wrap.el.removeClass("_no-alpha"),n.sliders.alpha.input.removeAttr("hidden")),n.options.matchInput?n.wrap.el.css({"font-size":n.input.css.fontSize,"line-height":n.input.css.lineHeight}):n.wrap.el.css({"font-size":"","line-height":""}),L(n),this},show:function(t){return t=t||Q(this),t.controls.hidden=!1,t.swatch.button.attr("aria-expanded",!0),t.controls.el.removeAttr("hidden"),_(t),$(document).on("click.colourPickerControls touchend.colourPickerControls focusin.colourPickerControls",function(n){$(n.target).closest(t.wrap.el).length||J.hide(t)}),this},hide:function(t){return t=t||Q(this),t.controls.hidden=!0,t.swatch.button.attr("aria-expanded",!1),t.controls.el.attr("hidden","hidden"),_(t),$(document).off("click.colourPickerControls touchend.colourPickerControls focusin.colourPickerControls"),this},toggle:function(t){return t=t||Q(this),t.controls.hidden?J.show(t):J.hide(t),this},hue:function(t,n){return n=n||Q(this),arguments.length?(n.sliders.hue.input.val(t).trigger("change"),this):n.sliders.hue.value},saturation:function(t,n){return n=n||Q(this),arguments.length?(n.sliders.saturation.input.val(t).trigger("change"),this):n.sliders.saturation.value},value:function(t,n){return n=n||Q(this),arguments.length?(n.sliders.value.input.val(t).trigger("change"),this):n.sliders.value.value},alpha:function(t,n){return n=n||Q(this),arguments.length?(n.sliders.alpha.input.val(t).trigger("change"),this):n.sliders.alpha.value},val:function(t,n){return n=n||Q(this),arguments.length?(m(t,n),this):n.value}},$.fn.colourPicker=function(t){return J[t]?J[t].apply(this,[].slice.call(arguments,1)):"object"!=typeof t&&t?void $.error("‘"+t+"’ doesn’t exist on ColourPicker"):J.init.apply(this,arguments)},$("input[type=colour]").colourPicker()}(jQuery,tinycolor);